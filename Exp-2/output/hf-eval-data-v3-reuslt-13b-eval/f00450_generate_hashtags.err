2023-11-30 19:13:21.557836: I tensorflow/core/platform/cpu_feature_guard.cc:182] This TensorFlow binary is optimized to use available CPU instructions in performance-critical operations.
To enable the following instructions: AVX2 FMA, in other operations, rebuild TensorFlow with the appropriate compiler flags.
2023-11-30 19:13:22.287387: W tensorflow/compiler/tf2tensorrt/utils/py_utils.cc:38] TF-TRT Warning: Could not find TensorRT
config.json:   0%|                                                                    | 0.00/502 [00:00<?, ?B/s]config.json: 100%|██████████████████████████████████████████████████████████████| 502/502 [00:00<00:00, 144kB/s]
pytorch_model.bin:   0%|                                                             | 0.00/346M [00:00<?, ?B/s]pytorch_model.bin:   3%|█▌                                                  | 10.5M/346M [00:04<02:37, 2.12MB/s]pytorch_model.bin:   6%|███▏                                                | 21.0M/346M [00:06<01:40, 3.24MB/s]pytorch_model.bin:   9%|████▋                                               | 31.5M/346M [00:08<01:17, 4.07MB/s]pytorch_model.bin:  12%|██████▎                                             | 41.9M/346M [00:11<01:13, 4.13MB/s]pytorch_model.bin:  15%|███████▉                                            | 52.4M/346M [00:13<01:12, 4.03MB/s]pytorch_model.bin:  18%|█████████▍                                          | 62.9M/346M [00:16<01:07, 4.22MB/s]pytorch_model.bin:  21%|███████████                                         | 73.4M/346M [00:19<01:11, 3.78MB/s]pytorch_model.bin:  24%|████████████▌                                       | 83.9M/346M [00:22<01:10, 3.69MB/s]pytorch_model.bin:  27%|██████████████▏                                     | 94.4M/346M [00:26<01:19, 3.15MB/s]pytorch_model.bin:  30%|████████████████                                     | 105M/346M [00:30<01:15, 3.18MB/s]pytorch_model.bin:  33%|█████████████████▋                                   | 115M/346M [00:33<01:11, 3.23MB/s]pytorch_model.bin:  36%|███████████████████▎                                 | 126M/346M [00:36<01:08, 3.20MB/s]pytorch_model.bin:  39%|████████████████████▉                                | 136M/346M [00:39<01:00, 3.44MB/s]pytorch_model.bin:  42%|██████████████████████▌                              | 147M/346M [00:42<00:58, 3.40MB/s]pytorch_model.bin:  46%|████████████████████████                             | 157M/346M [00:45<00:54, 3.46MB/s]pytorch_model.bin:  49%|█████████████████████████▋                           | 168M/346M [00:51<01:06, 2.69MB/s]pytorch_model.bin:  52%|███████████████████████████▎                         | 178M/346M [00:56<01:10, 2.38MB/s]pytorch_model.bin:  55%|████████████████████████████▉                        | 189M/346M [01:01<01:07, 2.31MB/s]pytorch_model.bin:  58%|██████████████████████████████▌                      | 199M/346M [01:08<01:12, 2.03MB/s]pytorch_model.bin:  61%|████████████████████████████████▏                    | 210M/346M [01:14<01:11, 1.90MB/s]pytorch_model.bin:  64%|█████████████████████████████████▊                   | 220M/346M [01:22<01:15, 1.65MB/s]pytorch_model.bin:  67%|███████████████████████████████████▎                 | 231M/346M [01:34<01:25, 1.34MB/s]pytorch_model.bin:  70%|████████████████████████████████████▉                | 241M/346M [01:43<01:23, 1.25MB/s]pytorch_model.bin:  73%|██████████████████████████████████████▌              | 252M/346M [01:53<01:18, 1.19MB/s]pytorch_model.bin:  76%|████████████████████████████████████████▏            | 262M/346M [02:02<01:09, 1.20MB/s]pytorch_model.bin:  79%|█████████████████████████████████████████▊           | 273M/346M [02:10<00:59, 1.23MB/s]pytorch_model.bin:  82%|███████████████████████████████████████████▍         | 283M/346M [02:17<00:48, 1.30MB/s]pytorch_model.bin:  85%|█████████████████████████████████████████████        | 294M/346M [02:27<00:43, 1.19MB/s]pytorch_model.bin:  88%|███████████████████████████████████████████████▌      | 304M/346M [02:43<00:42, 975kB/s]pytorch_model.bin:  88%|███████████████████████████████████████████████▌      | 304M/346M [02:55<00:42, 975kB/s]pytorch_model.bin:  91%|█████████████████████████████████████████████████▏    | 315M/346M [02:56<00:33, 914kB/s]pytorch_model.bin:  94%|██████████████████████████████████████████████████▊   | 325M/346M [03:09<00:23, 873kB/s]pytorch_model.bin:  97%|████████████████████████████████████████████████████▍ | 336M/346M [03:22<00:11, 850kB/s]pytorch_model.bin:  97%|████████████████████████████████████████████████████▍ | 336M/346M [03:35<00:11, 850kB/s]pytorch_model.bin: 100%|██████████████████████████████████████████████████████| 346M/346M [03:38<00:00, 780kB/s]pytorch_model.bin: 100%|█████████████████████████████████████████████████████| 346M/346M [03:38<00:00, 1.58MB/s]
Traceback (most recent call last):
  File "./f00450_generate_hashtags.py", line 29, in generate_hashtags
    img = Image.open(r.raw).convert('RGB')
  File "/root/autodl-tmp/conda-envs/py38/lib/python3.8/site-packages/PIL/Image.py", line 3305, in open
    raise UnidentifiedImageError(msg)
PIL.UnidentifiedImageError: cannot identify image file <_io.BytesIO object at 0x7f63577a9b30>

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "./f00450_generate_hashtags.py", line 61, in <module>
    test_generate_hashtags()
  File "./f00450_generate_hashtags.py", line 46, in test_generate_hashtags
    image_features = generate_hashtags(image_url)
  File "./f00450_generate_hashtags.py", line 31, in generate_hashtags
    raise Exception("Error while downloading image from URL")
Exception: Error while downloading image from URL
