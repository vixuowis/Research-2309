2023-11-30 19:18:00.776161: I tensorflow/core/platform/cpu_feature_guard.cc:182] This TensorFlow binary is optimized to use available CPU instructions in performance-critical operations.
To enable the following instructions: AVX2 FMA, in other operations, rebuild TensorFlow with the appropriate compiler flags.
2023-11-30 19:18:01.567773: W tensorflow/compiler/tf2tensorrt/utils/py_utils.cc:38] TF-TRT Warning: Could not find TensorRT
No model was supplied, defaulted to google/vit-base-patch16-224 and revision 5dca96d (https://huggingface.co/google/vit-base-patch16-224).
Using a pipeline without specifying a model name and revision in production is not recommended.
config.json:   0%|                                                                  | 0.00/69.7k [00:00<?, ?B/s]config.json: 100%|██████████████████████████████████████████████████████████| 69.7k/69.7k [00:00<00:00, 172kB/s]config.json: 100%|██████████████████████████████████████████████████████████| 69.7k/69.7k [00:00<00:00, 171kB/s]
model.safetensors:   0%|                                                             | 0.00/346M [00:00<?, ?B/s]model.safetensors:   3%|█▌                                                  | 10.5M/346M [00:08<04:45, 1.18MB/s]model.safetensors:   6%|███▏                                                | 21.0M/346M [00:15<03:49, 1.42MB/s]model.safetensors:   9%|████▋                                               | 31.5M/346M [00:23<03:57, 1.33MB/s]model.safetensors:  12%|██████▎                                             | 41.9M/346M [00:35<04:32, 1.12MB/s]model.safetensors:  12%|██████▎                                             | 41.9M/346M [00:47<04:32, 1.12MB/s]model.safetensors:  15%|████████                                             | 52.4M/346M [00:48<05:03, 968kB/s]model.safetensors:  18%|█████████▋                                           | 62.9M/346M [01:01<05:10, 913kB/s]model.safetensors:  21%|███████████▏                                         | 73.4M/346M [01:14<05:15, 865kB/s]model.safetensors:  24%|████████████▊                                        | 83.9M/346M [01:24<04:44, 922kB/s]model.safetensors:  24%|████████████▊                                        | 83.9M/346M [01:37<04:44, 922kB/s]model.safetensors:  27%|██████████████▍                                      | 94.4M/346M [01:38<04:47, 876kB/s]model.safetensors:  27%|██████████████▍                                      | 94.4M/346M [01:57<04:47, 876kB/s]model.safetensors:  30%|████████████████▎                                     | 105M/346M [02:07<06:38, 606kB/s]model.safetensors:  30%|████████████████▎                                     | 105M/346M [02:17<06:38, 606kB/s]model.safetensors:  33%|█████████████████▉                                    | 115M/346M [02:36<07:39, 502kB/s]model.safetensors:  33%|█████████████████▉                                    | 115M/346M [02:47<07:39, 502kB/s]model.safetensors:  36%|███████████████████▌                                  | 126M/346M [03:01<07:49, 470kB/s]model.safetensors:  36%|███████████████████▌                                  | 126M/346M [03:17<07:49, 470kB/s]model.safetensors:  39%|█████████████████████▎                                | 136M/346M [03:28<07:52, 445kB/s]model.safetensors:  39%|█████████████████████▎                                | 136M/346M [03:47<07:52, 445kB/s]model.safetensors:  42%|██████████████████████▉                               | 147M/346M [03:49<07:16, 457kB/s]model.safetensors:  42%|██████████████████████▉                               | 147M/346M [04:07<07:16, 457kB/s]model.safetensors:  45%|████████████████████████▌                             | 157M/346M [04:09<06:37, 475kB/s]model.safetensors:  45%|████████████████████████▌                             | 157M/346M [04:27<06:37, 475kB/s]model.safetensors:  48%|██████████████████████████▏                           | 168M/346M [04:34<06:27, 461kB/s]model.safetensors:  48%|██████████████████████████▏                           | 168M/346M [04:47<06:27, 461kB/s]model.safetensors:  51%|███████████████████████████▊                          | 178M/346M [04:55<05:58, 468kB/s]model.safetensors:  51%|███████████████████████████▊                          | 178M/346M [05:07<05:58, 468kB/s]model.safetensors:  55%|█████████████████████████████▍                        | 189M/346M [05:08<04:54, 535kB/s]model.safetensors:  58%|███████████████████████████████                       | 199M/346M [05:21<04:04, 601kB/s]model.safetensors:  61%|████████████████████████████████▋                     | 210M/346M [05:34<03:29, 653kB/s]model.safetensors:  64%|██████████████████████████████████▎                   | 220M/346M [05:46<02:58, 707kB/s]model.safetensors:  64%|██████████████████████████████████▎                   | 220M/346M [05:57<02:58, 707kB/s]model.safetensors:  67%|███████████████████████████████████▉                  | 231M/346M [06:09<03:11, 603kB/s]model.safetensors:  70%|█████████████████████████████████████▌                | 241M/346M [06:24<02:46, 631kB/s]model.safetensors:  73%|███████████████████████████████████████▏              | 252M/346M [06:36<02:18, 684kB/s]model.safetensors:  73%|███████████████████████████████████████▏              | 252M/346M [06:47<02:18, 684kB/s]model.safetensors:  76%|████████████████████████████████████████▉             | 262M/346M [06:52<02:03, 680kB/s]model.safetensors:  76%|████████████████████████████████████████▉             | 262M/346M [07:07<02:03, 680kB/s]model.safetensors:  79%|██████████████████████████████████████████▌           | 273M/346M [07:12<01:58, 623kB/s]model.safetensors:  82%|████████████████████████████████████████████▏         | 283M/346M [07:24<01:33, 675kB/s]model.safetensors:  82%|████████████████████████████████████████████▏         | 283M/346M [07:37<01:33, 675kB/s]model.safetensors:  85%|█████████████████████████████████████████████▊        | 294M/346M [07:41<01:18, 668kB/s]model.safetensors:  88%|███████████████████████████████████████████████▍      | 304M/346M [07:53<00:59, 712kB/s]model.safetensors:  88%|███████████████████████████████████████████████▍      | 304M/346M [08:07<00:59, 712kB/s]model.safetensors:  91%|█████████████████████████████████████████████████     | 315M/346M [08:21<00:56, 558kB/s]model.safetensors:  91%|█████████████████████████████████████████████████     | 315M/346M [08:37<00:56, 558kB/s]model.safetensors:  94%|██████████████████████████████████████████████████▋   | 325M/346M [08:42<00:39, 538kB/s]model.safetensors:  94%|██████████████████████████████████████████████████▋   | 325M/346M [08:57<00:39, 538kB/s]model.safetensors:  97%|████████████████████████████████████████████████████▎ | 336M/346M [09:00<00:19, 550kB/s]model.safetensors:  97%|████████████████████████████████████████████████████▎ | 336M/346M [09:17<00:19, 550kB/s]model.safetensors: 100%|█████████████████████████████████████████████████████▉| 346M/346M [09:18<00:00, 562kB/s]model.safetensors: 100%|██████████████████████████████████████████████████████| 346M/346M [09:18<00:00, 565kB/s]model.safetensors: 100%|██████████████████████████████████████████████████████| 346M/346M [09:18<00:00, 620kB/s]
preprocessor_config.json:   0%|                                                       | 0.00/160 [00:00<?, ?B/s]preprocessor_config.json: 100%|████████████████████████████████████████████████| 160/160 [00:00<00:00, 30.8kB/s]
Traceback (most recent call last):
  File "./f00487_classify_device_image.py", line 70, in <module>
    test_classify_device_image()
  File "./f00487_classify_device_image.py", line 44, in test_classify_device_image
    prediction = classify_device_image(image_path, class_names)
  File "./f00487_classify_device_image.py", line 22, in classify_device_image
    device = pipeline("image-classification", 
  File "/root/autodl-tmp/conda-envs/py38/lib/python3.8/site-packages/transformers/pipelines/__init__.py", line 1070, in pipeline
    return pipeline_class(model=model, framework=framework, task=task, **kwargs)
  File "/root/autodl-tmp/conda-envs/py38/lib/python3.8/site-packages/transformers/pipelines/image_classification.py", line 57, in __init__
    super().__init__(*args, **kwargs)
  File "/root/autodl-tmp/conda-envs/py38/lib/python3.8/site-packages/transformers/pipelines/base.py", line 830, in __init__
    self._preprocess_params, self._forward_params, self._postprocess_params = self._sanitize_parameters(**kwargs)
TypeError: _sanitize_parameters() got an unexpected keyword argument 'pretrained'
