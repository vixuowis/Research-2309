{"path": "output/hf-eval-data-v3-valid/f00442_predict_carbon_emissions.py", "content": "# function_import --------------------\n\nimport json\nimport joblib\nimport pandas as pd\n\n# function_code --------------------\n\ndef predict_carbon_emissions(model_path: str, config_path: str, data_path: str) -> pd.DataFrame:\n    \"\"\"\n    Predict the carbon emissions of different facilities based on the provided data.\n\n    Args:\n        model_path (str): The path to the pretrained model.\n        config_path (str): The path to the configuration file.\n        data_path (str): The path to the data file.\n\n    Returns:\n        pd.DataFrame: The predicted carbon emissions for each facility.\n    \"\"\"\n    model = joblib.load(model_path)\n    config = json.load(open(config_path))\n    features = config['features']\n\n    data = pd.read_csv(data_path)\n    data = data[features]\n    data.columns = ['feat_' + str(col) for col in data.columns]\n\n    predictions = model.predict(data)\n    return predictions\n\n# test_function_code --------------------\n\ndef test_predict_carbon_emissions():\n    \"\"\"\n    Test the predict_carbon_emissions function.\n    \"\"\"\n    model_path = 'model.joblib'\n    config_path = 'config.json'\n    data_path = 'data.csv'\n\n    try:\n        predictions = predict_carbon_emissions(model_path, config_path, data_path)\n        assert isinstance(predictions, pd.DataFrame), 'The result is not a DataFrame.'\n        assert not predictions.empty, 'The DataFrame is empty.'\n    except FileNotFoundError:\n        print('Test files not found.')\n    except Exception as e:\n        print(f'An error occurred: {e}')\n    else:\n        print('All tests passed.')\n\n# call_test_function_code --------------------\n\ntest_predict_carbon_emissions()", "function_import": "# function_import --------------------\n\nimport json\nimport joblib\nimport pandas as pd\n\n", "function_code": "# function_code --------------------\n\ndef predict_carbon_emissions(model_path: str, config_path: str, data_path: str) -> pd.DataFrame:\n    \"\"\"\n    Predict the carbon emissions of different facilities based on the provided data.\n\n    Args:\n        model_path (str): The path to the pretrained model.\n        config_path (str): The path to the configuration file.\n        data_path (str): The path to the data file.\n\n    Returns:\n        pd.DataFrame: The predicted carbon emissions for each facility.\n    \"\"\"\n    model = joblib.load(model_path)\n    config = json.load(open(config_path))\n    features = config['features']\n\n    data = pd.read_csv(data_path)\n    data = data[features]\n    data.columns = ['feat_' + str(col) for col in data.columns]\n\n    predictions = model.predict(data)\n    return predictions\n\n", "test_function_code": "# test_function_code --------------------\n\ndef test_predict_carbon_emissions():\n    \"\"\"\n    Test the predict_carbon_emissions function.\n    \"\"\"\n    model_path = 'model.joblib'\n    config_path = 'config.json'\n    data_path = 'data.csv'\n\n    try:\n        predictions = predict_carbon_emissions(model_path, config_path, data_path)\n        assert isinstance(predictions, pd.DataFrame), 'The result is not a DataFrame.'\n        assert not predictions.empty, 'The DataFrame is empty.'\n    except FileNotFoundError:\n        print('Test files not found.')\n    except Exception as e:\n        print(f'An error occurred: {e}')\n    else:\n        print('All tests passed.')\n\n", "call_test_function_code": "# call_test_function_code --------------------\n\ntest_predict_carbon_emissions()", "instruct": "# function_import --------------------\n\nimport json\nimport joblib\nimport pandas as pd\n\n# function_code --------------------\n\ndef predict_carbon_emissions(model_path: str, config_path: str, data_path: str) -> pd.DataFrame:\n    \"\"\"\n    Predict the carbon emissions of different facilities based on the provided data.\n\n    Args:\n        model_path (str): The path to the pretrained model.\n        config_path (str): The path to the configuration file.\n        data_path (str): The path to the data file.\n\n    Returns:\n        pd.DataFrame: The predicted carbon emissions for each facility.\n    \"\"\"", "answer": "\n    model = joblib.load(model_path)\n    config = json.load(open(config_path))\n    features = config['features']\n\n    data = pd.read_csv(data_path)\n    data = data[features]\n    data.columns = ['feat_' + str(col) for col in data.columns]\n\n    predictions = model.predict(data)\n    return predictions\n\n", "prediction": "\n    \n    # load model, config and data\n    model = joblib.load(model_path)\n    config = json.loads(open(config_path).read())\n    data   = pd.read_csv(data_path)\n\n    # get columns for one-hot encoding and the target column\n    columns  = [column for column in data.columns if 'ohe' in column] + config['target']\n    \n    # get one-hot encoded data, train test split and predict emissions with model \n    data_one_hot      = pd.get_dummies(data, columns=config['columns_one_hot'])\n    X_train, y_train  = data_one_hot[config['features']], data_one_hot[config['target']]\n    \n    # make predictions and merge with original dataframe\n    emissions         = pd.DataFrame(model.predict(X_train), columns=config['target'])\n    emissions         = emissions.merge(data, how='left', on=config['join_on'])[config['features_emissions']]\n    \n    return emissions"}