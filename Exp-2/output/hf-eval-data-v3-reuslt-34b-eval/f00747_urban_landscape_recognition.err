2023-12-01 02:02:57.883769: I tensorflow/core/platform/cpu_feature_guard.cc:182] This TensorFlow binary is optimized to use available CPU instructions in performance-critical operations.
To enable the following instructions: AVX2 FMA, in other operations, rebuild TensorFlow with the appropriate compiler flags.
2023-12-01 02:02:58.623660: W tensorflow/compiler/tf2tensorrt/utils/py_utils.cc:38] TF-TRT Warning: Could not find TensorRT
preprocessor_config.json:   0%|                                                       | 0.00/272 [00:00<?, ?B/s]preprocessor_config.json: 100%|████████████████████████████████████████████████| 272/272 [00:00<00:00, 34.5kB/s]
/root/autodl-tmp/conda-envs/py38/lib/python3.8/site-packages/transformers/models/segformer/feature_extraction_segformer.py:28: FutureWarning: The class SegformerFeatureExtractor is deprecated and will be removed in version 5 of Transformers. Please use SegformerImageProcessor instead.
  warnings.warn(
/root/autodl-tmp/conda-envs/py38/lib/python3.8/site-packages/transformers/models/segformer/image_processing_segformer.py:101: FutureWarning: The `reduce_labels` parameter is deprecated and will be removed in a future version. Please use `do_reduce_labels` instead.
  warnings.warn(
tf_model.h5:   0%|                                                                  | 0.00/15.3M [00:00<?, ?B/s]tf_model.h5:  69%|███████████████████████████████████████▊                  | 10.5M/15.3M [01:26<00:39, 121kB/s]tf_model.h5:  69%|███████████████████████████████████████▊                  | 10.5M/15.3M [01:46<00:39, 121kB/s]tf_model.h5: 100%|█████████████████████████████████████████████████████████| 15.3M/15.3M [02:34<00:00, 94.5kB/s]tf_model.h5: 100%|█████████████████████████████████████████████████████████| 15.3M/15.3M [02:34<00:00, 98.9kB/s]2023-12-01 02:05:42.549984: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1639] Created device /job:localhost/replica:0/task:0/device:GPU:0 with 46275 MB memory:  -> device: 0, name: NVIDIA A40, pci bus id: 0000:81:00.0, compute capability: 8.6
2023-12-01 02:05:45.312173: I tensorflow/compiler/xla/stream_executor/cuda/cuda_dnn.cc:432] Loaded cuDNN version 8902
2023-12-01 02:05:46.002072: I tensorflow/compiler/xla/stream_executor/cuda/cuda_blas.cc:606] TensorFloat-32 will be used for the matrix multiplication. This will only be logged once.
2023-12-01 02:05:46.086617: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0xefb5a210 initialized for platform CUDA (this does not guarantee that XLA will be used). Devices:
2023-12-01 02:05:46.086653: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): NVIDIA A40, Compute Capability 8.6
2023-12-01 02:05:46.446998: I ./tensorflow/compiler/jit/device_compiler.h:186] Compiled cluster using XLA!  This line is logged at most once for the lifetime of the process.

WARNING:tensorflow:5 out of the last 5 calls to <function Conv._jit_compiled_convolution_op at 0x7fd5e871a940> triggered tf.function retracing. Tracing is expensive and the excessive number of tracings could be due to (1) creating @tf.function repeatedly in a loop, (2) passing tensors with different shapes, (3) passing Python objects instead of tensors. For (1), please define your @tf.function outside of the loop. For (2), @tf.function has reduce_retracing=True option that can avoid unnecessary retracing. For (3), please refer to https://www.tensorflow.org/guide/function#controlling_retracing and https://www.tensorflow.org/api_docs/python/tf/function for  more details.
WARNING:tensorflow:6 out of the last 6 calls to <function Conv._jit_compiled_convolution_op at 0x7fd5e86c44c0> triggered tf.function retracing. Tracing is expensive and the excessive number of tracings could be due to (1) creating @tf.function repeatedly in a loop, (2) passing tensors with different shapes, (3) passing Python objects instead of tensors. For (1), please define your @tf.function outside of the loop. For (2), @tf.function has reduce_retracing=True option that can avoid unnecessary retracing. For (3), please refer to https://www.tensorflow.org/guide/function#controlling_retracing and https://www.tensorflow.org/api_docs/python/tf/function for  more details.
All TF 2.0 model weights were used when initializing SegformerForSemanticSegmentation.

Some weights of SegformerForSemanticSegmentation were not initialized from the TF 2.0 model and are newly initialized: ['decode_head.batch_norm.running_mean', 'decode_head.batch_norm.running_var']
You should probably TRAIN this model on a down-stream task to be able to use it for predictions and inference.
