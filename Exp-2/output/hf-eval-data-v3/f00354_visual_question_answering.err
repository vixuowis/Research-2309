2023-11-11 20:25:30.344271: I tensorflow/core/util/port.cc:110] oneDNN custom operations are on. You may see slightly different numerical results due to floating-point round-off errors from different computation orders. To turn them off, set the environment variable `TF_ENABLE_ONEDNN_OPTS=0`.
2023-11-11 20:25:30.396909: I tensorflow/core/platform/cpu_feature_guard.cc:182] This TensorFlow binary is optimized to use available CPU instructions in performance-critical operations.
To enable the following instructions: AVX2 AVX512F AVX512_VNNI FMA, in other operations, rebuild TensorFlow with the appropriate compiler flags.
2023-11-11 20:25:31.253809: W tensorflow/compiler/tf2tensorrt/utils/py_utils.cc:38] TF-TRT Warning: Could not find TensorRT
Downloading (…)okenizer_config.json:   0%|                                                                           | 0.00/453 [00:00<?, ?B/s]Downloading (…)okenizer_config.json: 100%|████████████████████████████████████████████████████████████████████| 453/453 [00:00<00:00, 39.8kB/s]
Downloading (…)solve/main/vocab.txt:   0%|                                                                          | 0.00/232k [00:00<?, ?B/s]Downloading (…)solve/main/vocab.txt: 100%|███████████████████████████████████████████████████████████████████| 232k/232k [00:01<00:00, 151kB/s]Downloading (…)solve/main/vocab.txt: 100%|███████████████████████████████████████████████████████████████████| 232k/232k [00:01<00:00, 151kB/s]
Downloading (…)/main/tokenizer.json:   0%|                                                                          | 0.00/711k [00:00<?, ?B/s]Downloading (…)/main/tokenizer.json: 100%|███████████████████████████████████████████████████████████████████| 711k/711k [00:00<00:00, 965kB/s]Downloading (…)/main/tokenizer.json: 100%|███████████████████████████████████████████████████████████████████| 711k/711k [00:00<00:00, 963kB/s]
Downloading (…)cial_tokens_map.json:   0%|                                                                           | 0.00/125 [00:00<?, ?B/s]Downloading (…)cial_tokens_map.json: 100%|████████████████████████████████████████████████████████████████████| 125/125 [00:00<00:00, 65.8kB/s]
Downloading (…)lve/main/config.json:   0%|                                                                         | 0.00/2.82k [00:00<?, ?B/s]Downloading (…)lve/main/config.json: 100%|█████████████████████████████████████████████████████████████████| 2.82k/2.82k [00:00<00:00, 221kB/s]
Downloading pytorch_model.bin:   0%|                                                                                | 0.00/709M [00:00<?, ?B/s]Downloading pytorch_model.bin:   1%|█                                                                      | 10.5M/709M [00:01<01:54, 6.09MB/s]Downloading pytorch_model.bin:   3%|██                                                                     | 21.0M/709M [00:02<01:09, 9.89MB/s]Downloading pytorch_model.bin:   4%|███▏                                                                   | 31.5M/709M [00:02<00:55, 12.2MB/s]Downloading pytorch_model.bin:   6%|████▏                                                                  | 41.9M/709M [00:03<00:47, 14.1MB/s]Downloading pytorch_model.bin:   7%|█████▎                                                                 | 52.4M/709M [00:04<00:42, 15.4MB/s]Downloading pytorch_model.bin:   9%|██████▎                                                                | 62.9M/709M [00:04<00:40, 15.8MB/s]Downloading pytorch_model.bin:  10%|███████▎                                                               | 73.4M/709M [00:05<00:38, 16.5MB/s]Downloading pytorch_model.bin:  12%|████████▍                                                              | 83.9M/709M [00:05<00:37, 16.9MB/s]Downloading pytorch_model.bin:  13%|█████████▍                                                             | 94.4M/709M [00:06<00:36, 16.8MB/s]Downloading pytorch_model.bin:  15%|██████████▋                                                             | 105M/709M [00:07<00:34, 17.3MB/s]Downloading pytorch_model.bin:  16%|███████████▋                                                            | 115M/709M [00:07<00:35, 16.8MB/s]Downloading pytorch_model.bin:  18%|████████████▊                                                           | 126M/709M [00:08<00:33, 17.5MB/s]Downloading pytorch_model.bin:  19%|█████████████▊                                                          | 136M/709M [00:08<00:34, 16.6MB/s]Downloading pytorch_model.bin:  21%|██████████████▉                                                         | 147M/709M [00:09<00:33, 17.0MB/s]Downloading pytorch_model.bin:  22%|███████████████▉                                                        | 157M/709M [00:10<00:32, 16.7MB/s]Downloading pytorch_model.bin:  24%|█████████████████                                                       | 168M/709M [00:10<00:32, 16.9MB/s]Downloading pytorch_model.bin:  25%|██████████████████                                                      | 178M/709M [00:11<00:39, 13.6MB/s]Downloading pytorch_model.bin:  27%|███████████████████▏                                                    | 189M/709M [00:12<00:37, 14.0MB/s]Downloading pytorch_model.bin:  28%|████████████████████▏                                                   | 199M/709M [00:13<00:34, 14.6MB/s]Downloading pytorch_model.bin:  30%|█████████████████████▎                                                  | 210M/709M [00:13<00:32, 15.2MB/s]Downloading pytorch_model.bin:  31%|██████████████████████▎                                                 | 220M/709M [00:14<00:31, 15.3MB/s]Downloading pytorch_model.bin:  33%|███████████████████████▍                                                | 231M/709M [00:15<00:30, 15.8MB/s]Downloading pytorch_model.bin:  34%|████████████████████████▍                                               | 241M/709M [00:15<00:29, 15.9MB/s]Downloading pytorch_model.bin:  36%|█████████████████████████▌                                              | 252M/709M [00:16<00:29, 15.3MB/s]Downloading pytorch_model.bin:  37%|██████████████████████████▋                                             | 262M/709M [00:17<00:29, 15.1MB/s]Downloading pytorch_model.bin:  38%|███████████████████████████▋                                            | 273M/709M [00:18<00:29, 15.0MB/s]Downloading pytorch_model.bin:  40%|████████████████████████████▊                                           | 283M/709M [00:18<00:29, 14.6MB/s]Downloading pytorch_model.bin:  41%|█████████████████████████████▊                                          | 294M/709M [00:19<00:28, 14.7MB/s]Downloading pytorch_model.bin:  43%|██████████████████████████████▉                                         | 304M/709M [00:20<00:28, 14.1MB/s]Downloading pytorch_model.bin:  44%|███████████████████████████████▉                                        | 315M/709M [00:21<00:28, 13.8MB/s]Downloading pytorch_model.bin:  46%|█████████████████████████████████                                       | 325M/709M [00:21<00:27, 14.0MB/s]Downloading pytorch_model.bin:  47%|██████████████████████████████████                                      | 336M/709M [00:22<00:26, 14.3MB/s]Downloading pytorch_model.bin:  49%|███████████████████████████████████▏                                    | 346M/709M [00:23<00:24, 14.7MB/s]Downloading pytorch_model.bin:  50%|████████████████████████████████████▏                                   | 357M/709M [00:23<00:23, 15.1MB/s]Downloading pytorch_model.bin:  52%|█████████████████████████████████████▎                                  | 367M/709M [00:24<00:27, 12.6MB/s]Downloading pytorch_model.bin:  53%|██████████████████████████████████████▎                                 | 377M/709M [00:25<00:25, 13.1MB/s]Downloading pytorch_model.bin:  55%|███████████████████████████████████████▍                                | 388M/709M [00:26<00:23, 13.7MB/s]Downloading pytorch_model.bin:  56%|████████████████████████████████████████▍                               | 398M/709M [00:27<00:21, 14.4MB/s]Downloading pytorch_model.bin:  58%|█████████████████████████████████████████▌                              | 409M/709M [00:27<00:20, 15.0MB/s]Downloading pytorch_model.bin:  59%|██████████████████████████████████████████▌                             | 419M/709M [00:28<00:18, 15.2MB/s]Downloading pytorch_model.bin:  61%|███████████████████████████████████████████▋                            | 430M/709M [00:29<00:18, 15.3MB/s]Downloading pytorch_model.bin:  62%|████████████████████████████████████████████▋                           | 440M/709M [00:29<00:17, 15.1MB/s]Downloading pytorch_model.bin:  64%|█████████████████████████████████████████████▊                          | 451M/709M [00:30<00:16, 15.2MB/s]Downloading pytorch_model.bin:  65%|██████████████████████████████████████████████▊                         | 461M/709M [00:31<00:15, 15.5MB/s]Downloading pytorch_model.bin:  67%|███████████████████████████████████████████████▉                        | 472M/709M [00:31<00:15, 15.3MB/s]Downloading pytorch_model.bin:  68%|████████████████████████████████████████████████▉                       | 482M/709M [00:32<00:14, 15.5MB/s]Downloading pytorch_model.bin:  70%|██████████████████████████████████████████████████                      | 493M/709M [00:33<00:13, 15.8MB/s]Downloading pytorch_model.bin:  71%|███████████████████████████████████████████████████▏                    | 503M/709M [00:33<00:12, 16.1MB/s]Downloading pytorch_model.bin:  72%|████████████████████████████████████████████████████▏                   | 514M/709M [00:34<00:12, 16.1MB/s]Downloading pytorch_model.bin:  74%|█████████████████████████████████████████████████████▎                  | 524M/709M [00:34<00:11, 16.2MB/s]Downloading pytorch_model.bin:  75%|██████████████████████████████████████████████████████▎                 | 535M/709M [00:35<00:10, 15.8MB/s]Downloading pytorch_model.bin:  77%|███████████████████████████████████████████████████████▍                | 545M/709M [00:36<00:10, 16.0MB/s]Downloading pytorch_model.bin:  78%|████████████████████████████████████████████████████████▍               | 556M/709M [00:36<00:09, 16.0MB/s]Downloading pytorch_model.bin:  80%|█████████████████████████████████████████████████████████▌              | 566M/709M [00:37<00:08, 16.0MB/s]Downloading pytorch_model.bin:  81%|██████████████████████████████████████████████████████████▌             | 577M/709M [00:38<00:08, 16.1MB/s]Downloading pytorch_model.bin:  83%|███████████████████████████████████████████████████████████▋            | 587M/709M [00:38<00:07, 16.0MB/s]Downloading pytorch_model.bin:  84%|████████████████████████████████████████████████████████████▋           | 598M/709M [00:39<00:06, 15.9MB/s]Downloading pytorch_model.bin:  86%|█████████████████████████████████████████████████████████████▊          | 608M/709M [00:40<00:06, 16.2MB/s]Downloading pytorch_model.bin:  87%|██████████████████████████████████████████████████████████████▊         | 619M/709M [00:40<00:05, 15.8MB/s]Downloading pytorch_model.bin:  89%|███████████████████████████████████████████████████████████████▉        | 629M/709M [00:41<00:05, 15.6MB/s]Downloading pytorch_model.bin:  90%|████████████████████████████████████████████████████████████████▉       | 640M/709M [00:42<00:04, 15.9MB/s]Downloading pytorch_model.bin:  92%|██████████████████████████████████████████████████████████████████      | 650M/709M [00:42<00:03, 15.8MB/s]Downloading pytorch_model.bin:  93%|███████████████████████████████████████████████████████████████████     | 661M/709M [00:43<00:03, 15.0MB/s]Downloading pytorch_model.bin:  95%|████████████████████████████████████████████████████████████████████▏   | 671M/709M [00:44<00:02, 14.3MB/s]Downloading pytorch_model.bin:  96%|█████████████████████████████████████████████████████████████████████▏  | 682M/709M [00:45<00:01, 13.8MB/s]Downloading pytorch_model.bin:  98%|██████████████████████████████████████████████████████████████████████▎ | 692M/709M [00:45<00:01, 14.5MB/s]Downloading pytorch_model.bin:  99%|███████████████████████████████████████████████████████████████████████▎| 703M/709M [00:47<00:00, 11.9MB/s]Downloading pytorch_model.bin: 100%|████████████████████████████████████████████████████████████████████████| 709M/709M [00:47<00:00, 12.3MB/s]Downloading pytorch_model.bin: 100%|████████████████████████████████████████████████████████████████████████| 709M/709M [00:47<00:00, 14.9MB/s]
Traceback (most recent call last):
  File "./f00354_visual_question_answering.py", line 42, in <module>
    test_visual_question_answering()
  File "./f00354_visual_question_answering.py", line 33, in test_visual_question_answering
    assert isinstance(visual_question_answering(image_path, question), str)
  File "./f00354_visual_question_answering.py", line 21, in visual_question_answering
    vqa_pipeline = pipeline(type='visual-question-answering', model=model, tokenizer=tokenizer)
  File "/root/miniconda3/envs/py38/lib/python3.8/site-packages/transformers/pipelines/__init__.py", line 758, in pipeline
    raise RuntimeError(
RuntimeError: Inferring the task automatically requires to check the hub with a model_id defined as a `str`.GitModel(
  (embeddings): GitEmbeddings(
    (word_embeddings): Embedding(30522, 768, padding_idx=0)
    (position_embeddings): Embedding(1024, 768)
    (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
    (dropout): Dropout(p=0.1, inplace=False)
  )
  (image_encoder): GitVisionModel(
    (vision_model): GitVisionTransformer(
      (embeddings): GitVisionEmbeddings(
        (patch_embedding): Conv2d(3, 768, kernel_size=(16, 16), stride=(16, 16), bias=False)
        (position_embedding): Embedding(901, 768)
      )
      (pre_layrnorm): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
      (encoder): GitVisionEncoder(
        (layers): ModuleList(
          (0-11): 12 x GitVisionEncoderLayer(
            (self_attn): GitVisionAttention(
              (k_proj): Linear(in_features=768, out_features=768, bias=True)
              (v_proj): Linear(in_features=768, out_features=768, bias=True)
              (q_proj): Linear(in_features=768, out_features=768, bias=True)
              (out_proj): Linear(in_features=768, out_features=768, bias=True)
            )
            (layer_norm1): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
            (mlp): GitVisionMLP(
              (activation_fn): QuickGELUActivation()
              (fc1): Linear(in_features=768, out_features=3072, bias=True)
              (fc2): Linear(in_features=3072, out_features=768, bias=True)
            )
            (layer_norm2): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
          )
        )
      )
      (post_layernorm): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
    )
  )
  (encoder): GitEncoder(
    (layer): ModuleList(
      (0-5): 6 x GitLayer(
        (attention): GitAttention(
          (self): GitSelfAttention(
            (query): Linear(in_features=768, out_features=768, bias=True)
            (key): Linear(in_features=768, out_features=768, bias=True)
            (value): Linear(in_features=768, out_features=768, bias=True)
            (dropout): Dropout(p=0.1, inplace=False)
          )
          (output): GitSelfOutput(
            (dense): Linear(in_features=768, out_features=768, bias=True)
            (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
            (dropout): Dropout(p=0.1, inplace=False)
          )
        )
        (intermediate): GitIntermediate(
          (dense): Linear(in_features=768, out_features=3072, bias=True)
          (intermediate_act_fn): GELUActivation()
        )
        (output): GitOutput(
          (dense): Linear(in_features=3072, out_features=768, bias=True)
          (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
          (dropout): Dropout(p=0.1, inplace=False)
        )
      )
    )
  )
  (visual_projection): GitProjection(
    (visual_projection): Sequential(
      (0): Linear(in_features=768, out_features=768, bias=True)
      (1): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
    )
  )
) is not a valid model_id.
