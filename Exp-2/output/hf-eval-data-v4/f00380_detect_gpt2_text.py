# requirements_file --------------------

!pip install -U transformers

# function_import --------------------

from transformers import pipeline

# function_code --------------------

def detect_gpt2_text(text):
    """
    Detect whether the given text is generated by GPT-2.

    Parameters:
        text (str): The text to be analyzed.

    Returns:
        dict: The prediction result containing label and score.
    """
    pipe = pipeline('text-classification', model='roberta-base-openai-detector')
    prediction = pipe(text)
    return prediction

# test_function_code --------------------

def test_detect_gpt2_text():
    print("Testing started.")
    # Test case 1: Known GPT-2 generated text
    gpt2_text = 'In a shocking finding, scientist discovered a herd of unicorns living in a remote, previously unexplored valley, in the Andes Mountains.'
    prediction = detect_gpt2_text(gpt2_text)
    assert prediction[0]['label'] == 'LABEL_1', f"Test case 1 failed: {prediction}"

    # Test case 2: Known human-written text
    human_text = 'Yesterday was a beautiful sunny day and we enjoyed a family picnic in the park.'
    prediction = detect_gpt2_text(human_text)
    assert prediction[0]['label'] == 'LABEL_0', f"Test case 2 failed: {prediction}"

    # Test case 3: Ambiguous text
    ambiguous_text = 'This sentence is rather plain and could be written by either human or AI.'
    prediction = detect_gpt2_text(ambiguous_text)
    # Not asserting in the ambiguous case as it can be either LABEL_0 or LABEL_1
    print("Ambiguous case prediction: ", prediction)

    print("Testing finished.")

# Run the test function
test_detect_gpt2_text()