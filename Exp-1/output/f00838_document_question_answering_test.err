Downloading (…)lve/main/config.json:   0%|                                                                       | 0.00/893 [00:00<?, ?B/s]Downloading (…)lve/main/config.json: 100%|████████████████████████████████████████████████████████████████| 893/893 [00:00<00:00, 86.0kB/s]
Downloading model.safetensors:   0%|                                                                            | 0.00/511M [00:00<?, ?B/s]Downloading model.safetensors:   2%|█▎                                                                 | 10.5M/511M [00:01<01:29, 5.62MB/s]Downloading model.safetensors:   4%|██▋                                                                | 21.0M/511M [00:02<00:54, 8.92MB/s]Downloading model.safetensors:   6%|████                                                               | 31.5M/511M [00:03<00:42, 11.3MB/s]Downloading model.safetensors:   8%|█████▍                                                             | 41.9M/511M [00:03<00:37, 12.6MB/s]Downloading model.safetensors:  10%|██████▊                                                            | 52.4M/511M [00:04<00:33, 13.6MB/s]Downloading model.safetensors:  12%|████████▏                                                          | 62.9M/511M [00:05<00:30, 14.5MB/s]Downloading model.safetensors:  14%|█████████▌                                                         | 73.4M/511M [00:05<00:30, 14.5MB/s]Downloading model.safetensors:  16%|██████████▉                                                        | 83.9M/511M [00:06<00:28, 15.0MB/s]Downloading model.safetensors:  18%|████████████▎                                                      | 94.4M/511M [00:07<00:27, 15.3MB/s]Downloading model.safetensors:  21%|█████████████▉                                                      | 105M/511M [00:07<00:26, 15.5MB/s]Downloading model.safetensors:  23%|███████████████▎                                                    | 115M/511M [00:08<00:25, 15.3MB/s]Downloading model.safetensors:  25%|████████████████▋                                                   | 126M/511M [00:09<00:24, 15.7MB/s]Downloading model.safetensors:  27%|██████████████████▏                                                 | 136M/511M [00:09<00:24, 15.4MB/s]Downloading model.safetensors:  29%|███████████████████▌                                                | 147M/511M [00:10<00:23, 15.8MB/s]Downloading model.safetensors:  31%|████████████████████▉                                               | 157M/511M [00:11<00:22, 15.7MB/s]Downloading model.safetensors:  33%|██████████████████████▎                                             | 168M/511M [00:11<00:21, 15.8MB/s]Downloading model.safetensors:  35%|███████████████████████▋                                            | 178M/511M [00:12<00:21, 15.7MB/s]Downloading model.safetensors:  37%|█████████████████████████                                           | 189M/511M [00:13<00:20, 15.9MB/s]Downloading model.safetensors:  39%|██████████████████████████▌                                         | 199M/511M [00:13<00:19, 15.9MB/s]Downloading model.safetensors:  41%|███████████████████████████▉                                        | 210M/511M [00:14<00:19, 15.2MB/s]Downloading model.safetensors:  43%|█████████████████████████████▎                                      | 220M/511M [00:15<00:18, 15.5MB/s]Downloading model.safetensors:  45%|██████████████████████████████▋                                     | 231M/511M [00:15<00:18, 15.1MB/s]Downloading model.safetensors:  47%|████████████████████████████████                                    | 241M/511M [00:16<00:17, 15.7MB/s]Downloading model.safetensors:  49%|█████████████████████████████████▍                                  | 252M/511M [00:17<00:16, 15.5MB/s]Downloading model.safetensors:  51%|██████████████████████████████████▊                                 | 262M/511M [00:17<00:15, 15.8MB/s]Downloading model.safetensors:  53%|████████████████████████████████████▎                               | 273M/511M [00:18<00:15, 15.8MB/s]Downloading model.safetensors:  55%|█████████████████████████████████████▋                              | 283M/511M [00:19<00:14, 15.5MB/s]Downloading model.safetensors:  57%|███████████████████████████████████████                             | 294M/511M [00:20<00:16, 13.3MB/s]Downloading model.safetensors:  59%|████████████████████████████████████████▍                           | 304M/511M [00:21<00:15, 13.7MB/s]Downloading model.safetensors:  62%|█████████████████████████████████████████▊                          | 315M/511M [00:21<00:13, 14.2MB/s]Downloading model.safetensors:  64%|███████████████████████████████████████████▏                        | 325M/511M [00:22<00:12, 14.9MB/s]Downloading model.safetensors:  66%|████████████████████████████████████████████▋                       | 336M/511M [00:22<00:11, 15.3MB/s]Downloading model.safetensors:  68%|██████████████████████████████████████████████                      | 346M/511M [00:23<00:10, 15.3MB/s]Downloading model.safetensors:  70%|███████████████████████████████████████████████▍                    | 357M/511M [00:24<00:09, 15.8MB/s]Downloading model.safetensors:  72%|████████████████████████████████████████████████▊                   | 367M/511M [00:24<00:09, 15.6MB/s]Downloading model.safetensors:  74%|██████████████████████████████████████████████████▏                 | 377M/511M [00:25<00:08, 15.7MB/s]Downloading model.safetensors:  76%|███████████████████████████████████████████████████▌                | 388M/511M [00:26<00:07, 15.7MB/s]Downloading model.safetensors:  78%|█████████████████████████████████████████████████████               | 398M/511M [00:26<00:07, 15.6MB/s]Downloading model.safetensors:  80%|██████████████████████████████████████████████████████▍             | 409M/511M [00:27<00:06, 15.6MB/s]Downloading model.safetensors:  82%|███████████████████████████████████████████████████████▊            | 419M/511M [00:28<00:05, 16.0MB/s]Downloading model.safetensors:  84%|█████████████████████████████████████████████████████████▏          | 430M/511M [00:28<00:05, 15.7MB/s]Downloading model.safetensors:  86%|██████████████████████████████████████████████████████████▌         | 440M/511M [00:29<00:04, 16.0MB/s]Downloading model.safetensors:  88%|███████████████████████████████████████████████████████████▉        | 451M/511M [00:30<00:03, 15.7MB/s]Downloading model.safetensors:  90%|█████████████████████████████████████████████████████████████▎      | 461M/511M [00:31<00:03, 12.8MB/s]Downloading model.safetensors:  92%|██████████████████████████████████████████████████████████████▊     | 472M/511M [00:32<00:02, 13.2MB/s]Downloading model.safetensors:  94%|████████████████████████████████████████████████████████████████▏   | 482M/511M [00:32<00:02, 13.7MB/s]Downloading model.safetensors:  96%|█████████████████████████████████████████████████████████████████▌  | 493M/511M [00:33<00:01, 13.7MB/s]Downloading model.safetensors:  98%|██████████████████████████████████████████████████████████████████▉ | 503M/511M [00:34<00:00, 14.0MB/s]Downloading model.safetensors: 100%|████████████████████████████████████████████████████████████████████| 511M/511M [00:34<00:00, 13.8MB/s]Downloading model.safetensors: 100%|████████████████████████████████████████████████████████████████████| 511M/511M [00:34<00:00, 14.6MB/s]
Some weights of the model checkpoint at magorshunov/layoutlm-invoices were not used when initializing LayoutLMForQuestionAnswering: ['token_classifier_head.bias', 'token_classifier_head.weight']
- This IS expected if you are initializing LayoutLMForQuestionAnswering from the checkpoint of a model trained on another task or with another architecture (e.g. initializing a BertForSequenceClassification model from a BertForPreTraining model).
- This IS NOT expected if you are initializing LayoutLMForQuestionAnswering from the checkpoint of a model that you expect to be exactly identical (initializing a BertForSequenceClassification model from a BertForSequenceClassification model).
Downloading (…)okenizer_config.json:   0%|                                                                       | 0.00/315 [00:00<?, ?B/s]Downloading (…)okenizer_config.json: 100%|████████████████████████████████████████████████████████████████| 315/315 [00:00<00:00, 22.8kB/s]
Downloading (…)olve/main/vocab.json:   0%|                                                                      | 0.00/798k [00:00<?, ?B/s]Downloading (…)olve/main/vocab.json: 100%|███████████████████████████████████████████████████████████████| 798k/798k [00:00<00:00, 866kB/s]Downloading (…)olve/main/vocab.json: 100%|███████████████████████████████████████████████████████████████| 798k/798k [00:00<00:00, 864kB/s]
Downloading (…)olve/main/merges.txt:   0%|                                                                      | 0.00/456k [00:00<?, ?B/s]Downloading (…)olve/main/merges.txt: 100%|██████████████████████████████████████████████████████████████| 456k/456k [00:00<00:00, 4.18MB/s]Downloading (…)olve/main/merges.txt: 100%|██████████████████████████████████████████████████████████████| 456k/456k [00:00<00:00, 4.14MB/s]
Downloading (…)/main/tokenizer.json:   0%|                                                                     | 0.00/1.36M [00:00<?, ?B/s]Downloading (…)/main/tokenizer.json: 100%|████████████████████████████████████████████████████████████| 1.36M/1.36M [00:00<00:00, 3.93MB/s]Downloading (…)/main/tokenizer.json: 100%|████████████████████████████████████████████████████████████| 1.36M/1.36M [00:00<00:00, 3.91MB/s]
Downloading (…)cial_tokens_map.json:   0%|                                                                       | 0.00/239 [00:00<?, ?B/s]Downloading (…)cial_tokens_map.json: 100%|█████████████████████████████████████████████████████████████████| 239/239 [00:00<00:00, 135kB/s]
Traceback (most recent call last):
  File "output/f00838_document_question_answering_test.py", line 5, in <module>
    result = document_question_answering(url, question)
  File "/root/Experiments/output/f00838_document_question_answering.py", line 19, in document_question_answering
    preds = doc_question_answerer(question=question, image=image)
  File "/root/miniconda3/envs/py38/lib/python3.8/site-packages/transformers/pipelines/document_question_answering.py", line 271, in __call__
    return super().__call__(inputs, **kwargs)
  File "/root/miniconda3/envs/py38/lib/python3.8/site-packages/transformers/pipelines/base.py", line 1132, in __call__
    return next(
  File "/root/miniconda3/envs/py38/lib/python3.8/site-packages/transformers/pipelines/pt_utils.py", line 124, in __next__
    item = next(self.iterator)
  File "/root/miniconda3/envs/py38/lib/python3.8/site-packages/transformers/pipelines/pt_utils.py", line 266, in __next__
    processed = self.infer(next(self.iterator), **self.params)
  File "/root/miniconda3/envs/py38/lib/python3.8/site-packages/torch/utils/data/dataloader.py", line 633, in __next__
    data = self._next_data()
  File "/root/miniconda3/envs/py38/lib/python3.8/site-packages/torch/utils/data/dataloader.py", line 677, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
  File "/root/miniconda3/envs/py38/lib/python3.8/site-packages/torch/utils/data/_utils/fetch.py", line 32, in fetch
    data.append(next(self.dataset_iter))
  File "/root/miniconda3/envs/py38/lib/python3.8/site-packages/transformers/pipelines/pt_utils.py", line 183, in __next__
    processed = next(self.subiterator)
  File "/root/miniconda3/envs/py38/lib/python3.8/site-packages/transformers/pipelines/document_question_answering.py", line 313, in preprocess
    raise ValueError(
ValueError: If you provide an image without word_boxes, then the pipeline will run OCR using Tesseract, but pytesseract is not available
